<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amgen Horizon - HCP Engagement Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --amgen-blue: #0066B2;
            --amgen-dark: #003D7A;
            --tepezza-purple: #6B4C9A;
            --krystexxa-green: #00A651;
            --uplizna-teal: #00A3AD;
            --critical: #D32F2F;
            --warning: #F57C00;
            --success: #388E3C;
            --bg-light: #F8F9FB;
            --bg-white: #FFFFFF;
            --text-primary: #212121;
            --text-secondary: #757575;
            --border: #E0E0E0;
        }

        body {
            font-family: 'Source Sans Pro', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
        }

        .dashboard {
            display: grid;
            grid-template-columns: 260px 1fr;
            min-height: 100vh;
        }

        .sidebar {
            background: linear-gradient(180deg, var(--amgen-blue) 0%, var(--amgen-dark) 100%);
            color: white;
            padding: 0;
            box-shadow: 4px 0 12px rgba(0,0,0,0.1);
        }

        .brand-header {
            padding: 24px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .logo {
            font-size: 26px;
            font-weight: 700;
            margin-bottom: 4px;
            letter-spacing: -0.5px;
        }

        .tagline {
            font-size: 11px;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1.2px;
        }

        .brand-selector {
            padding: 20px;
            background: rgba(0,0,0,0.15);
        }

        .brand-selector label {
            display: block;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            opacity: 0.9;
        }

        .brand-select {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1);
            color: white;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
        }

        .brand-select option {
            background: var(--amgen-dark);
        }

        .nav-menu {
            padding: 20px 0;
        }

        .nav-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            font-weight: 600;
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .nav-item.active {
            background: rgba(255,255,255,0.15);
            border-left-color: #4FC3F7;
        }

        .main-content {
            padding: 24px 32px;
            overflow-y: auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
        }

        .page-title {
            font-size: 30px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 4px;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--amgen-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--amgen-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,102,178,0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--amgen-blue);
            border: 2px solid var(--amgen-blue);
        }

        .btn-secondary:hover {
            background: var(--bg-light);
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .kpi-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid;
            transition: transform 0.2s;
        }

        .kpi-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.12);
        }

        .kpi-card.tepezza { border-left-color: var(--tepezza-purple); }
        .kpi-card.krystexxa { border-left-color: var(--krystexxa-green); }
        .kpi-card.uplizna { border-left-color: var(--uplizna-teal); }
        .kpi-card.critical { border-left-color: var(--critical); }

        .kpi-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .kpi-value {
            font-size: 36px;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 8px;
        }

        .kpi-change {
            font-size: 13px;
            font-weight: 600;
        }

        .kpi-change.positive { color: var(--success); }
        .kpi-change.negative { color: var(--critical); }

        .section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .filter-group {
            display: flex;
            gap: 8px;
        }

        .filter-chip {
            padding: 6px 16px;
            border-radius: 20px;
            border: 1px solid var(--border);
            background: white;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-chip:hover {
            border-color: var(--amgen-blue);
            color: var(--amgen-blue);
        }

        .filter-chip.active {
            background: var(--amgen-blue);
            color: white;
            border-color: var(--amgen-blue);
        }

        .alert-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .alert {
            background: var(--bg-light);
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid;
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 16px;
            align-items: start;
            transition: all 0.2s;
        }

        .alert:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .alert.critical { border-left-color: var(--critical); background: linear-gradient(90deg, rgba(211,47,47,0.05) 0%, var(--bg-light) 100%); }
        .alert.warning { border-left-color: var(--warning); background: linear-gradient(90deg, rgba(245,124,0,0.05) 0%, var(--bg-light) 100%); }
        .alert.info { border-left-color: var(--amgen-blue); }

        .alert-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .alert.critical .alert-icon { background: rgba(211,47,47,0.1); }
        .alert.warning .alert-icon { background: rgba(245,124,0,0.1); }
        .alert.info .alert-icon { background: rgba(0,102,178,0.1); }

        .alert-content {
            flex: 1;
        }

        .alert-header {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 8px;
        }

        .alert-badge {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .alert-badge.tepezza { background: rgba(107,76,154,0.15); color: var(--tepezza-purple); }
        .alert-badge.krystexxa { background: rgba(0,166,81,0.15); color: var(--krystexxa-green); }
        .alert-badge.uplizna { background: rgba(0,163,173,0.15); color: var(--uplizna-teal); }

        .alert-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .alert-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .alert-meta {
            display: flex;
            gap: 20px;
            font-size: 12px;
            color: var(--text-secondary);
            font-family: 'Roboto Mono', monospace;
        }

        .alert-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .alert-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s;
        }

        .alert-btn.send-email {
            background: var(--amgen-blue);
            color: white;
        }

        .alert-btn.send-email:hover {
            background: var(--amgen-dark);
        }

        .alert-btn.acknowledge {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .alert-btn.acknowledge:hover {
            background: var(--bg-light);
            border-color: var(--amgen-blue);
            color: var(--amgen-blue);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin-bottom: 24px;
        }

        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .chart-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        canvas {
            max-height: 300px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .email-preview {
            background: var(--bg-light);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid var(--border);
        }

        .email-subject {
            font-weight: 700;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
        }

        .email-body {
            line-height: 1.8;
            color: var(--text-secondary);
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
        }

        @media (max-width: 1200px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 968px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            .sidebar {
                display: none;
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: none;
            z-index: 2000;
            animation: slideIn 0.3s;
        }

        .notification.show {
            display: block;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .pdf-export-section {
            margin-top: 24px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            color: white;
            text-align: center;
        }

        .pdf-export-section h3 {
            margin-bottom: 12px;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <aside class="sidebar">
            <div class="brand-header">
                <div class="logo">AMGEN</div>
                <div class="tagline">Horizon Brands Portal</div>
            </div>

            <div class="brand-selector">
                <label>Select Brand</label>
                <select class="brand-select" id="brandFilter" onchange="filterByBrand()">
                    <option value="all">All Brands</option>
                    <option value="tepezza">TEPEZZA (Thyroid Eye Disease)</option>
                    <option value="krystexxa">KRYSTEXXA (Chronic Gout)</option>
                    <option value="uplizna">UPLIZNA (NMOSD)</option>
                </select>
            </div>

            <nav class="nav-menu">
                <div class="nav-item active">
                    <span>üìä</span> Dashboard
                </div>
                <div class="nav-item">
                    <span>üîî</span> HCP Alerts
                </div>
                <div class="nav-item">
                    <span>üìß</span> Email Campaign
                </div>
                <div class="nav-item">
                    <span>üë•</span> HCP Directory
                </div>
                <div class="nav-item">
                    <span>üìà</span> Analytics
                </div>
                <div class="nav-item">
                    <span>‚öôÔ∏è</span> Settings
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <div class="header">
                <div>
                    <h1 class="page-title">HCP Engagement Dashboard</h1>
                    <p class="page-subtitle">Omnichannel Customer Experience Analytics ‚Ä¢ Last updated: 5 min ago</p>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="refreshDashboard()">
                        <span>üîÑ</span> Refresh
                    </button>
                    <button class="btn btn-primary" onclick="exportToPDF()">
                        <span>üìÑ</span> Export PDF
                    </button>
                </div>
            </div>

            <div class="kpi-grid">
                <div class="kpi-card tepezza">
                    <div class="kpi-label">TEPEZZA Engagement</div>
                    <div class="kpi-value">1,247</div>
                    <div class="kpi-change positive">‚Üë 18% vs last month</div>
                </div>
                <div class="kpi-card krystexxa">
                    <div class="kpi-label">KRYSTEXXA Engagement</div>
                    <div class="kpi-value">892</div>
                    <div class="kpi-change positive">‚Üë 12% vs last month</div>
                </div>
                <div class="kpi-card uplizna">
                    <div class="kpi-label">UPLIZNA Engagement</div>
                    <div class="kpi-value">634</div>
                    <div class="kpi-change positive">‚Üë 23% vs last month</div>
                </div>
                <div class="kpi-card critical">
                    <div class="kpi-label">Avg Satisfaction Score</div>
                    <div class="kpi-value">4.6/5</div>
                    <div class="kpi-change positive">‚Üë 0.3 vs last month</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-container">
                    <h3 class="chart-title">HCP Engagement Trends (Last 6 Months)</h3>
                    <canvas id="engagementChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">Brand Distribution</h3>
                    <canvas id="brandChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">Customer Satisfaction by Brand</h3>
                    <canvas id="satisfactionChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">Alert Status Overview</h3>
                    <canvas id="alertStatusChart"></canvas>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Active HCP Alerts</h2>
                    <div class="filter-group">
                        <button class="filter-chip active" onclick="filterAlerts('all')">All</button>
                        <button class="filter-chip" onclick="filterAlerts('critical')">Critical</button>
                        <button class="filter-chip" onclick="filterAlerts('warning')">Warning</button>
                        <button class="filter-chip" onclick="filterAlerts('info')">Info</button>
                    </div>
                </div>

                <div class="alert-list" id="alertList"></div>
            </div>

            <div class="pdf-export-section">
                <h3>üìä Comprehensive Reporting</h3>
                <p>Export this dashboard as a PDF report including all metrics, charts, and alert details for stakeholder review.</p>
            </div>
        </main>
    </div>

    <div class="modal" id="emailModal">
        <div class="modal-content">
            <h2 class="modal-header">Email Preview</h2>
            <div class="email-preview" id="emailPreview"></div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeEmailModal()">Cancel</button>
                <button class="btn btn-primary" onclick="sendEmail()">Send Email</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        const alertsData = [
            {
                id: 1,
                type: 'critical',
                brand: 'tepezza',
                title: 'Low Satisfaction Score - Dr. Sarah Chen',
                description: 'Dr. Chen (Endocrinology, Boston) rated TEPEZZA resources 2/5. Needs more real-world efficacy data for chronic TED patients. Follow-up required within 24 hours.',
                hcp: 'Dr. Sarah Chen',
                specialty: 'Endocrinology',
                location: 'Boston, MA',
                time: '15 min ago',
                satisfaction: 2.0
            },
            {
                id: 2,
                type: 'warning',
                brand: 'krystexxa',
                title: 'Pending Educational Request - Dr. Michael Torres',
                description: 'Dr. Torres requested detailed infusion protocol materials for KRYSTEXXA with methotrexate co-administration. Requested materials: AGILE study data, administration guidelines.',
                hcp: 'Dr. Michael Torres',
                specialty: 'Rheumatology',
                location: 'San Diego, CA',
                time: '2 hours ago',
                satisfaction: 4.2
            },
            {
                id: 3,
                type: 'critical',
                brand: 'uplizna',
                title: 'Adverse Event Inquiry - Dr. Jennifer Park',
                description: 'Dr. Park seeking immediate guidance on potential infusion reaction management for UPLIZNA. Patient experiencing mild headache during infusion. Safety team CCed.',
                hcp: 'Dr. Jennifer Park',
                specialty: 'Neurology',
                location: 'Seattle, WA',
                time: '45 min ago',
                satisfaction: 4.5
            },
            {
                id: 4,
                type: 'warning',
                brand: 'tepezza',
                title: 'Reimbursement Support Request - Dr. David Kumar',
                description: 'Dr. Kumar office requested assistance with prior authorization for TEPEZZA. Patient has active TED. Needs expedited review for insurance approval.',
                hcp: 'Dr. David Kumar',
                specialty: 'Ophthalmology',
                location: 'Houston, TX',
                time: '3 hours ago',
                satisfaction: 3.8
            },
            {
                id: 5,
                type: 'info',
                brand: 'krystexxa',
                title: 'Positive Feedback - Dr. Amanda White',
                description: 'Dr. White rated recent webinar 5/5: Excellent update on 60-minute infusion data from AGILE trial. Very helpful for clinical practice implementation.',
                hcp: 'Dr. Amanda White',
                specialty: 'Rheumatology',
                location: 'Miami, FL',
                time: '5 hours ago',
                satisfaction: 5.0
            },
            {
                id: 6,
                type: 'warning',
                brand: 'uplizna',
                title: 'Sample Request - Dr. Robert Lewis',
                description: 'Dr. Lewis requesting UPLIZNA patient education materials for newly diagnosed NMOSD patient. Materials needed: dosing schedule, infusion site info, MINT study overview.',
                hcp: 'Dr. Robert Lewis',
                specialty: 'Neurology',
                location: 'Atlanta, GA',
                time: '6 hours ago',
                satisfaction: 4.3
            },
            {
                id: 7,
                type: 'info',
                brand: 'tepezza',
                title: 'Portal Engagement - Dr. Lisa Martinez',
                description: 'Dr. Martinez accessed TEPEZZA prescribing information, dosing calculator, and hearing monitoring guidelines. High engagement with digital resources.',
                hcp: 'Dr. Lisa Martinez',
                specialty: 'Ophthalmology',
                location: 'Phoenix, AZ',
                time: '1 day ago',
                satisfaction: 4.7
            },
            {
                id: 8,
                type: 'critical',
                brand: 'krystexxa',
                title: 'Clinical Question - Dr. Thomas Anderson',
                description: 'Urgent: Dr. Anderson needs clarification on G6PD screening protocol before initiating KRYSTEXXA. Patient has family history of hemolytic anemia. MSL callback requested.',
                hcp: 'Dr. Thomas Anderson',
                specialty: 'Rheumatology',
                location: 'Denver, CO',
                time: '1 day ago',
                satisfaction: 4.0
            }
        ];

        let currentFilter = 'all';
        let currentBrand = 'all';

        const emailTemplates = {
            critical: {
                subject: 'URGENT: Follow-up Required - BRAND HCP Support',
                body: 'Dear HCP,\n\nThank you for your recent inquiry. We understand the urgency and want to ensure you receive the support you need.\n\nOur Medical Science Liaison team will contact you within the next 4 hours.\n\nFor immediate assistance:\nPhone: 1-800-77-AMGEN\nEmail: medinfo@amgen.com\n\nBest regards,\nAmgen Medical Affairs Team'
            },
            warning: {
                subject: 'Re: BRAND Information Request',
                body: 'Dear HCP,\n\nThank you for reaching out. We appreciate your interest and are here to support you.\n\nOur team will prepare the requested materials and send them within 24-48 hours.\n\nResources available on our HCP portal:\n- Prescribing Information\n- Dosing Guidelines\n- Clinical Study Data\n- Patient Education Materials\n\nBest regards,\nAmgen Customer Experience Team'
            },
            info: {
                subject: 'Thank You for Your Feedback - BRAND',
                body: 'Dear HCP,\n\nThank you for your valuable feedback. We truly appreciate your engagement.\n\nYour insights help us improve our educational programs and support services.\n\nUpcoming events:\n- Monthly Clinical Updates Webinar\n- Regional Educational Symposiums\n- Virtual Office Hours with MSLs\n\nBest regards,\nAmgen Medical Education Team'
            }
        };

        const safetyInfo = {
            tepezza: 'TEPEZZA may cause severe hearing impairment including hearing loss, which in some cases may be permanent. Monitor hearing before, during, and after treatment.',
            krystexxa: 'WARNING: ANAPHYLAXIS AND INFUSION REACTIONS. Anaphylaxis and infusion reactions have been reported during and after administration of KRYSTEXXA.',
            uplizna: 'UPLIZNA can cause infusion reactions. Patients should be monitored during and after infusion. Risk of infections - delay administration in patients with active infection.'
        };

        function renderAlerts() {
            const container = document.getElementById('alertList');
            let filtered = alertsData;

            if (currentFilter !== 'all') {
                filtered = filtered.filter(a => a.type === currentFilter);
            }

            if (currentBrand !== 'all') {
                filtered = filtered.filter(a => a.brand === currentBrand);
            }

            container.innerHTML = filtered.map(alert => `
                <div class="alert ${alert.type}" data-id="${alert.id}">
                    <div class="alert-icon">
                        ${alert.type === 'critical' ? 'üö®' : alert.type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}
                    </div>
                    <div class="alert-content">
                        <div class="alert-header">
                            <span class="alert-badge ${alert.brand}">${alert.brand.toUpperCase()}</span>
                        </div>
                        <div class="alert-title">${alert.title}</div>
                        <div class="alert-description">${alert.description}</div>
                        <div class="alert-meta">
                            <span>üë§ ${alert.hcp}</span>
                            <span>üè• ${alert.specialty}</span>
                            <span>üìç ${alert.location}</span>
                            <span>üïê ${alert.time}</span>
                            <span>‚≠ê ${alert.satisfaction}/5.0</span>
                        </div>
                    </div>
                    <div class="alert-actions">
                        <button class="alert-btn send-email" onclick="previewEmail(${alert.id})">
                            üìß Send Email
                        </button>
                        <button class="alert-btn acknowledge" onclick="acknowledgeAlert(${alert.id})">
                            ‚úì Acknowledge
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function filterAlerts(type) {
            currentFilter = type;
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.classList.remove('active');
            });
            event.target.classList.add('active');
            renderAlerts();
        }

        function filterByBrand() {
            currentBrand = document.getElementById('brandFilter').value;
            renderAlerts();
        }

        function previewEmail(alertId) {
            const alert = alertsData.find(a => a.id === alertId);
            const template = emailTemplates[alert.type];
            
            const subject = template.subject.replace('BRAND', alert.brand.toUpperCase());
            const body = template.body.replace(/BRAND/g, alert.brand.toUpperCase()).replace(/HCP/g, alert.hcp);
            
            const safetyText = safetyInfo[alert.brand];

            document.getElementById('emailPreview').innerHTML = `
                <div class="email-subject"><strong>Subject:</strong> ${subject}</div>
                <div class="email-body">
                    ${body.replace(/\n/g, '<br><br>')}
                    <br><br><strong>Important Safety Information:</strong><br>
                    ${safetyText}
                </div>
            `;

            document.getElementById('emailModal').classList.add('active');
        }

        function closeEmailModal() {
            document.getElementById('emailModal').classList.remove('active');
        }

        function sendEmail() {
            closeEmailModal();
            showNotification('‚úÖ Email sent successfully to HCP');
        }

        function acknowledgeAlert(alertId) {
            showNotification('‚úÖ Alert acknowledged');
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function refreshDashboard() {
            showNotification('üîÑ Dashboard refreshed');
            renderAlerts();
            renderCharts();
        }

        function renderCharts() {
            const engagementCtx = document.getElementById('engagementChart').getContext('2d');
            new Chart(engagementCtx, {
                type: 'line',
                data: {
                    labels: ['Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
                    datasets: [
                        {
                            label: 'TEPEZZA',
                            data: [890, 945, 1020, 1085, 1150, 1247],
                            borderColor: '#6B4C9A',
                            backgroundColor: 'rgba(107,76,154,0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'KRYSTEXXA',
                            data: [680, 715, 750, 790, 835, 892],
                            borderColor: '#00A651',
                            backgroundColor: 'rgba(0,166,81,0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'UPLIZNA',
                            data: [420, 465, 510, 550, 590, 634],
                            borderColor: '#00A3AD',
                            backgroundColor: 'rgba(0,163,173,0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });

            const brandCtx = document.getElementById('brandChart').getContext('2d');
            new Chart(brandCtx, {
                type: 'doughnut',
                data: {
                    labels: ['TEPEZZA', 'KRYSTEXXA', 'UPLIZNA'],
                    datasets: [{
                        data: [1247, 892, 634],
                        backgroundColor: ['#6B4C9A', '#00A651', '#00A3AD']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });

            const satisfactionCtx = document.getElementById('satisfactionChart').getContext('2d');
            new Chart(satisfactionCtx, {
                type: 'bar',
                data: {
                    labels: ['TEPEZZA', 'KRYSTEXXA', 'UPLIZNA'],
                    datasets: [{
                        label: 'Satisfaction Score',
                        data: [4.5, 4.7, 4.6],
                        backgroundColor: ['#6B4C9A', '#00A651', '#00A3AD']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 5
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });

            const alertStatusCtx = document.getElementById('alertStatusChart').getContext('2d');
            new Chart(alertStatusCtx, {
                type: 'pie',
                data: {
                    labels: ['Resolved', 'In Progress', 'Pending'],
                    datasets: [{
                        data: [156, 42, 18],
                        backgroundColor: ['#388E3C', '#F57C00', '#D32F2F']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        function exportToPDF() {
            showNotification('üìÑ Generating PDF report...');
            
            const element = document.querySelector('.main-content');
            const opt = {
                margin: 10,
                filename: 'Amgen-HCP-Dashboard-' + new Date().toISOString().split('T')[0] + '.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            html2pdf().set(opt).from(element).save().then(() => {
                showNotification('‚úÖ PDF downloaded successfully');
            });
        }

        renderAlerts();
        renderCharts();
    </script>
</body>
</html>